{{ $data := index .Site.Data .Site.Language.Lang }}

<div id="map" class="relative my-6 overflow-x-auto">
    <div class="wrapper" x-data="taMap()" x-init="init()">
        {{range $index, $element := $data.map.items}}
        <div class="member border-4 border-secondary-dark rounded-full overflow-hidden"
            :class="{ 'running' : play[{{ $index }}], 'paused' : !play[{{ $index }}] }"
            data-name="{{ $element.name }}" data-origin="{{ $element.origin }}" data-local="{{ $element.local }}" data-description="{{ $element.description }}" data-image="{{ $element.image }}"
            style="--left:{{ $element.left }}%;--top:{{ $element.top }}%;--delay:{{ mul $index 2000 }}ms" @click="toggle({{ $index }})"
        >
            <img src="/img/{{ $element.image }}" alt="{{ printf "Portrait %s" $element.name }}" class="absolute inset-0 w-full h-full"
            />
        </div>
        <template x-if="modal">
            <div class="modal bg-white text-base text-gray-900 rounded-lg border border-gray-200 pl-12 pr-4 py-3 max-w-64 shadow-lg" :style="data.style">
                <img :src="data.image" :alt="data.name" class="absolute block left-0 top-0 w-16 h-16 rounded-full border-2 border-gray-300 border-opacity-50 -ml-8 -mt-2">
                <p class="text-xs font-bold" x-text="data.origin"></p>
                <p class="text-xl font-bold mb-1" x-text="data.name"></p>
                <p class="text-xs font-semibold uppercase mb-1">Located: <span x-text="data.local"></span></p>
                <p class="text-sm font-medium leading-snug" x-text="data.description"></p>
                <button type="button" @click="closeModal()" title="close" class="absolute flex-center bg-primary right-0 top-0 text-white w-8 h-8 -mr-4 -mt-2 rounded-full">
                    {{ partial "icon" (dict "name" "times" "size" "4") }}
                </button>
            </div>
        </template>
        {{ end }}
        <img src="/img/map.svg" alt="Temp Map" class="block w-full -z-1" />
    </div>
</div>

<style>

    .wrapper {
        position: relative;
        margin: 0 auto;
        width: 1130px;
        height: 544px;
    }
    
    .member {
        position: absolute;
        left: var(--left);
        top: var(--top);
        background-color: #466505;
        width: 52px;
        height: 52px;
        transform: translate(-50%, -50%);
        opacity: 0;
        cursor: pointer;
    }
    
    .member.running {
        animation-iteration-count: infinite;
        animation-timing-function: ease-in-out;
        animation-delay: var(--delay);
        animation-direction: normal;
        animation-name: animation-fade;
        animation-duration: 15s;
        animation-fill-mode: both;
    }
    .member.paused {
        opacity: 1;
    }
    
    .modal {
        position: absolute;
        left: var(--left);
        top: var(--top);
        transform: translate(-50%, -50%);
    }

    @keyframes animation-fade {
        0% {
            opacity: 0;
        }
        25% {
            opacity: 1;
        }
        50% {
            opacity: 1;
        }
        75% {
            opacity: 0;
        }
        100% {
            opacity: 0;
        }
    }
</style>

<script>
    var element = document.getElementById('map');
    {{/*  element.scrollLeft = 300;  */}}
    
    element.scroll({
        left: 300,
        behavior: 'smooth',
    });
</script>
