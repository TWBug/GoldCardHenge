{{ $logo := resources.Get "img/taiwan-gold-card-logo-white.svg" }}
{{ $topic := .Page.Params.topic }}
{{ $language := .Site.Language.Lang }}
{{ $data := index .Site.Data.navigation .Site.Language.Lang }}
{{ $url := .Page.Permalink }}
{{ $actual_language := .Site.Language.Lang }}

<div class="absolute inset-0 w-full h-full bg-white bg-opacity-75 backdrop-blur-2" x-on:click="toggleModal()"
    x-show="modal"
    x-transition:enter="transition transform ease-out duration-100"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition transform ease-in duration-100"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
></div>
<div class="absolute inset-y-0 right-0 w-3/4 h-full bg-nav-meta"
    x-show="modal"
    x-transition:enter="transition transform ease-out duration-200"
    x-transition:enter-start="opacity-0 translate-x-10"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition transform ease-in duration-100"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0 translate-x-10"
    >
    <button type="button" x-on:click="toggleModal()" class="absolute top-0 right-0 px-8 py-4 focus:bg-white focus:text-nav-start" >
        {{ partial "icon" (dict "name" "times" "size" "10") }}
    </button>
    <div class="flex flex-col h-full">
        <a href="{{ .Site.Home.RelPermalink }}" class="block pt-10 pl-6 pb-4 focus-white">
            <img src="{{ $logo.RelPermalink }}" class="w-1/2" alt="{{ partial "alt" ( dict "alt" (i18n "tego_logo") "lang" .Site.Language.Lang ) }}" />
        </a>
        <div class="flex items-center border-t border-b border-white border-opacity-50 mt-4 px-8" x-data="taLanguage()" x-init="init()">
            <div class="mr-2">
                {{ partial "icon" (dict "name" "language" "size" "6" "alt" (i18n "change_language")) }}
            </div>
            {{ range .Site.Languages }}
            {{ if lt .Weight 10 }}
            {{ $url := print "/" .Lang (substr $.RelPermalink 3) }}
            {{ if eq $actual_language .Lang }}
            <a
                href="{{ $url }}"
                class="block bg-nav-dark font-bold px-2 py-3 mx-1 focus:bg-white focus:text-black"
                tabindex="-1"
                @click.prevent="switchLanguage('{{ .Lang }}')"
                title="{{ i18n "change_language" }}"
            >
            {{ else }}
            <a
                href="{{ $url }}"
                class="block px-2 py-3 mx-1 focus:bg-white focus:text-black"
                @click.prevent="switchLanguage('{{ .Lang }}')"
                title="{{ i18n "change_language" }}"
            >
            {{ end }}
                {{ .LanguageName }}
            </a>
            {{ end }}
            {{ end }}
        </div>
        <ul class="text-2xl font-medium flex-grow-0 overflow-y-scroll">
            {{ range $data.items }}
                {{ if eq .topic $topic}}
                <li class="bg-yellow-400 text-black border-b border-white border-opacity-50 font-bold pl-4 py-2">
                {{ else }}
                <li class="border-b border-white border-opacity-50 pl-4 py-2">
                {{ end }}
                    <a href="/{{ print $language .link }}" class="inline-block p-2 focus-white">
                        {{ .name }}
                    </a>
                    {{ if .dropdown.links }}
                    <ul class="text-lg pl-4 pb-2">
                        {{ range .dropdown.links }}
                        <li>
                            <a href="/{{ print $language .link }}" class="inline-block p-2 focus-white">
                                {{ .name }}
                            </a>
                        </li>
                        {{ end }}
                    </ul>
                    {{ end }}
                </li>
            {{ end }}
        </ul>
    </div>
</div>

