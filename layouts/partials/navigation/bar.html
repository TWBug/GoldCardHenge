{{ $topic := .Page.Params.topic }}
{{ if not $topic }}
{{ if eq .Page.Section "categories" }}
{{ $topic = "eventsnews" }}
{{ else if eq .Page.Section "tags" }}
{{ $topic = "faq" }}
{{ else if eq .Page.Section "topics" }}
{{ $topic = "whytaiwan" }}
{{ end }}
{{ end }}
{{ $language := .Site.Language.Lang }}
{{ $data := index .Site.Data.navigation .Site.Language.Lang }}

<a href="{{ .Site.Home.RelPermalink }}" class="block w-1/2 max-w-48 px-4 py-4 lg:py-6 focus-primary">
    <img src="/img/taiwan-gold-card-logo.png" class="w-full" alt="{{ i18n "tego_logo" }}" />
</a>
<ul class="flex-grow hidden lg:flex justify-between items-center text-xl font-semibold ml-10">
    {{ range $data.items }}
    <li {{ if eq .topic $topic}}
        class="bg-yellow-400 self-stretch flex text-black font-bold"
        {{ else }}
        class="self-stretch flex hover:text-black hover:bg-white"
        {{ end }}
    >
        <a href="/{{ print $language .link }}" {{ if .dropdown }}
            @click.stop="toggleDropdown('{{ .topic }}', $event)" {{ end }}
            class="flex-center focus:bg-white focus:text-black px-4 xl:px-6"
            :class="{ 'bg-white text-black': {{ printf "dropdown.%s" .topic }} }"
            :aria-pressed="{{ printf "dropdown.%s" .topic }}"
            aria-controls="{{ printf "nav-dropdown-%s" .topic }}"
            :aria-expanded="{{ printf "dropdown.%s" .topic }}"
        >
            {{ if .dropdown }}
                <span class="mr-2">
                {{ .name }}
                </span>
                <span x-show="{{ printf "!dropdown.%s" .topic }}">
                    {{ partial "icon" (dict "name" "angle-down" "size" "6") }}
                </span>
                <span x-show="{{ printf "dropdown.%s" .topic }}" x-cloak>
                    {{ partial "icon" (dict "name" "angle-up" "size" "6") }}
                </span>
            {{ else }}
                <span>
                {{ .name }}
                </span>
            {{ end }}
        </a>
        {{ if .dropdown }}
        {{ partial "navigation/bar-dropdown" (dict "topic" .topic "dropdown" .dropdown "lang" $language "content" .content "all" $.Site ) }}
        {{ end }}
    </li>
    {{ end }}
</ul>
<div class="flex lg:hidden">
    <button type="button" data-cy="show-search" x-data="taSearchTrigger()" x-init="init('mobile')" @click="show()"  class="px-4 focus:bg-white focus:text-nav-start" >
    {{/*  <button type="button" data-cy="show-search" @click="toggleSearch()" class="px-4" >  */}}
        {{ partial "icon" (dict "name" "search" "size" "8") }}
    </button>
</div>
<div class="flex lg:hidden">
    <button type="button" x-on:click="toggleModal()" class="px-8 -mr-8 focus:bg-white focus:text-nav-start" >
        {{ partial "icon" (dict "name" "bars" "size" "8") }}
    </button>
    <div
        class="absolute top-nav-menu left-0 w-full bg-nav-end p-8"
        x-show="search"
        x-transition:enter="transition transform ease-out duration-200"
        x-transition:enter-start="opacity-0 -translate-y-10"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition transform ease-in duration-100"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0 -translate-y-10"
        x-cloak
    >
        <form class="text-base text-white m-0">
            <div class="flex items-center border border-nav-end bg-nav-dark rounded-lg px-4">
                {{ partial "icon" (dict "name" "search" "size" "4") }}
                <input id="search-box" type="text" placeholder="{{ i18n "search" }}" class="search-box flex-auto bg-transparent font-semibold placeholder-white px-4 py-2" />
            </div>
        </form>
    </div>
</div>


